# High-Risk Patients (Multiple admissions + readmissions)
SELECT 
    p.patient_id,
    p.name,
    COUNT(a.admission_id) AS total_visits,
    SUM(CASE WHEN a.readmitted_within_30_days THEN 1 ELSE 0 END) AS readmissions
FROM patients p
JOIN admissions a ON p.patient_id = a.patient_id
GROUP BY p.patient_id, p.name
HAVING COUNT(a.admission_id) >= 2
ORDER BY readmissions DESC;
